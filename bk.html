<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Notes App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f7f8fa;
            margin: 0;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: #333;
        }

        #addNoteBtn {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }

        #notesContainer {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        .note {
            background: white;
            border-radius: 8px;
            padding: 15px;
            width: 250px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .note .color-label {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            margin-bottom: 10px;
        }

        .note p {
            white-space: pre-wrap;
            margin: 10px 0;
        }

        .note-buttons {
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .note-buttons button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-left: 5px;
        }

        /* Modal */
        #modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            justify-content: center;
            align-items: center;
        }

        #modalContent {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
        }

        #modalContent textarea {
            width: 100%;
            height: 120px;
            resize: vertical;
            font-size: 16px;
            padding: 10px;
        }

        #colorPicker {
            margin-top: 10px;
            font-size: 16px;
            width: 100%;
            padding: 5px;
        }

        #modalButtons {
            margin-top: 15px;
            text-align: right;
        }

        #modalButtons button {
            margin-left: 10px;
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <h1>Notes App</h1>
    <button id="addNoteBtn">Add Note</button>
    <div id="notesContainer"></div>

    <!-- Modal -->
    <div id="modal">
        <div id="modalContent">
            <textarea id="noteText" placeholder="Write your note here..."></textarea>
            <select id="colorPicker" title="Select note color label">
                <option value="#f28b82" style="color:#f28b82">üî¥ Red</option>
                <option value="#fbbc04" style="color:#fbbc04">üü† Orange</option>
                <option value="#fff475" style="color:#fff475">üü° Yellow</option>
                <option value="#ccff90" style="color:#ccff90">üü¢ Green</option>
                <option value="#a7ffeb" style="color:#a7ffeb">üîµ Teal</option>
                <option value="#d7aefb" style="color:#d7aefb">üü£ Purple</option>
                <option value="#ffffff" style="color:#000000">‚ö™ White (no color)</option>
            </select>
            <div id="modalButtons">
                <button id="cancelBtn">Cancel</button>
                <button id="saveBtn">Save</button>
            </div>
        </div>
    </div>

    <script>
        // Elements
        const addNoteBtn = document.getElementById('addNoteBtn');
        const modal = document.getElementById('modal');
        const noteText = document.getElementById('noteText');
        const colorPicker = document.getElementById('colorPicker');
        const saveBtn = document.getElementById('saveBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const notesContainer = document.getElementById('notesContainer');

        // Notes array
        let notes = JSON.parse(localStorage.getItem('notes')) || [];

        // Track editing note index (-1 = new note)
        let editIndex = -1;

        function saveNotes() {
            localStorage.setItem('notes', JSON.stringify(notes));
        }

        function renderNotes() {
            notesContainer.innerHTML = '';
            if (notes.length === 0) {
                notesContainer.innerHTML = '<p>No notes yet. Click "Add Note" to create one!</p>';
                return;
            }
            notes.forEach((note, i) => {
                const noteEl = document.createElement('div');
                noteEl.className = 'note';
                noteEl.style.borderLeft = `8px solid ${note.color || '#fff'}`;

                noteEl.innerHTML = `
        <div class="color-label" style="background-color: ${note.color || '#fff'}"></div>
        <p>${escapeHtml(note.text)}</p>
        <div class="note-buttons">
          <button title="Edit note" onclick="openEditModal(${i})">‚úèÔ∏è</button>
          <button title="Delete note" onclick="deleteNote(${i})">üóëÔ∏è</button>
        </div>
      `;

                notesContainer.appendChild(noteEl);
            });
        }

        function escapeHtml(text) {
            // Prevent XSS by escaping html special chars
            return text.replace(/[&<>"']/g, function (m) {
                return ({
                    '&': '&amp;',
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&#39;'
                })[m];
            });
        }

        function openEditModal(index = -1) {
            editIndex = index;
            if (index === -1) {
                // New note
                noteText.value = '';
                colorPicker.value = '#ffffff';
            } else {
                const note = notes[index];
                noteText.value = note.text;
                colorPicker.value = note.color || '#ffffff';
            }
            modal.style.display = 'flex';
            noteText.focus();
        }

        function closeModal() {
            modal.style.display = 'none';
            editIndex = -1;
        }

        function saveNote() {
            const text = noteText.value.trim();
            const color = colorPicker.value;

            if (text.length === 0) {
                alert('Please enter some text for the note.');
                return;
            }

            if (editIndex === -1) {
                // Add new note
                notes.push({ text, color });
            } else {
                // Update existing note
                notes[editIndex] = { text, color };
            }

            saveNotes();
            renderNotes();
            closeModal();
        }

        function deleteNote(index) {
            if (confirm('Are you sure you want to delete this note?')) {
                notes.splice(index, 1);
                saveNotes();
                renderNotes();
            }
        }

        // Event listeners
        addNoteBtn.addEventListener('click', () => openEditModal());
        cancelBtn.addEventListener('click', closeModal);
        saveBtn.addEventListener('click', saveNote);

        // Close modal on outside click
        window.addEventListener('click', e => {
            if (e.target === modal) {
                closeModal();
            }
        });

        // Render notes on page load
        renderNotes();
    </script>

</body>

</html>